<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Test Cell Editors</title>
		<style>
			@import "../../../../dojo/resources/dojo.css";
			@import "../../../../dijit/themes/claro/claro.css";
			@import "../../../css/skins/claro.css";
		</style>
	</head>

	<body class="claro">
		<h2>Grid with editors</h2>
		<div id="grid"></div>

		<script src="../../../../dojo/dojo.js" data-dojo-config="async: 1"></script>

		<script>
			var grid,
				datachangeStack = [],
				ready = false,
				setEditorToTextBox,
				optionsData = [
					{id: "1", name: "one"},
					{id: "2", name: "two"},
					{id: "3", name: "three"},
					{id: "4", name: "four"},
					{id: "5", name: "five"}
				],
				optionsStore;

			require([
				'dojo/_base/declare',
				'dgrid/Grid',
				'dgrid/Editor',
				'dijit/form/TextBox',
				'dstore/Memory'
			], function (declare, Grid, Editor, TextBox, Memory) {
				optionsStore = new Memory({ data: optionsData });
				function createColumnConfig(editorType) {
					return {
						id: 'ID',
						name: {
							label: 'Name',
							editor: editorType || 'text'
						},
						description: {
							label: 'Description',
							editor: editorType || 'text',
							editOn: 'click'
						},
						options: {
							editor: 'select',
							editOn: 'click',
							editorArgs: { store: optionsStore, optionValueField: 'id', optionLabelField: 'name' }
						}
					};
				}

				grid = new (declare([Grid, Editor]))({
					columns: createColumnConfig('text')
				}, 'grid');

				grid.renderArray([
					{ id: 0, name: '1', description: 'one', options: "1" },
					{ id: 1, name: '2', description: 'two', options: "1" },
					{ id: 2, name: '3', description: 'three', options: "1" }
				]);

				// Push values received by the "dgrid-datachange" event into a global stack.
				// The functional test can read from this stack to verify the values it is
				// inputting are being emitted by the "dgrid-datachange" event.
				grid.on('dgrid-datachange', function (event) {
					datachangeStack.push(event.value);
				});

				setEditorToTextBox = function () {
					grid.set('columns', createColumnConfig(TextBox));
				};

				ready = true;
			});
		</script>
	</body>
</html>
